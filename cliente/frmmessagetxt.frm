version 5.00
begin vb.form frmmessagetxt 
   backcolor       =   &h8000000a&
   borderstyle     =   0  'none
   caption         =   "mensajes predefinidos"
   clientheight    =   4665
   clientleft      =   0
   clienttop       =   30
   clientwidth     =   4680
   clipcontrols    =   0   'false
   controlbox      =   0   'false
   linktopic       =   "form1"
   maxbutton       =   0   'false
   minbutton       =   0   'false
   scaleheight     =   311
   scalemode       =   3  'pixel
   scalewidth      =   312
   showintaskbar   =   0   'false
   startupposition =   2  'centerscreen
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   9
      left            =   1200
      tabindex        =   9
      top             =   3840
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   8
      left            =   1200
      tabindex        =   8
      top             =   3435
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   7
      left            =   1200
      tabindex        =   7
      top             =   3030
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   6
      left            =   1200
      tabindex        =   6
      top             =   2625
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   5
      left            =   1200
      tabindex        =   5
      top             =   2220
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   4
      left            =   1200
      tabindex        =   4
      top             =   1815
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   3
      left            =   1200
      tabindex        =   3
      top             =   1410
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   1
      left            =   1200
      tabindex        =   2
      top             =   600
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   0
      left            =   1200
      tabindex        =   1
      top             =   180
      width           =   3330
   end
   begin vb.textbox messagetxt 
      backcolor       =   &h00000000&
      borderstyle     =   0  'none
      beginproperty font 
         name            =   "ms sans serif"
         size            =   8.25
         charset         =   0
         weight          =   700
         underline       =   0   'false
         italic          =   0   'false
         strikethrough   =   0   'false
      endproperty
      forecolor       =   &h00ffffff&
      height          =   255
      index           =   2
      left            =   1200
      tabindex        =   0
      top             =   1005
      width           =   3330
   end
   begin vb.image imgcancelar 
      height          =   420
      left            =   2640
      tag             =   "1"
      top             =   4200
      width           =   1710
   end
   begin vb.image imgguardar 
      height          =   420
      left            =   360
      tag             =   "1"
      top             =   4200
      width           =   1710
   end
end
attribute vb_name = "frmmessagetxt"
attribute vb_globalnamespace = false
attribute vb_creatable = false
attribute vb_predeclaredid = true
attribute vb_exposed = false
option explicit

private clsformulario as clsformmovementmanager

private cbotonguardar as clsgraphicalbutton
private cbotoncancelar as clsgraphicalbutton

public lastpressed as clsgraphicalbutton

private sub form_load()
    dim i as long
    
    ' handles form movement (drag and drop).
    set clsformulario = new clsformmovementmanager
    clsformulario.initialize me
    
    for i = 0 to 9
        messagetxt(i) = custommessages.message(i)
    next i

    me.picture = loadpicture(app.path & "\graficos\ventanamensajespersonalizados.jpg")
    
    loadbuttons
    
end sub

private sub loadbuttons()
    dim grhpath as string
    
    grhpath = dirgraficos
    
    set cbotonguardar = new clsgraphicalbutton
    set cbotoncancelar = new clsgraphicalbutton
    
    set lastpressed = new clsgraphicalbutton

    call cbotonguardar.initialize(imgguardar, grhpath & "botonguardarcustommsg.jpg", grhpath & "botonguardarrollovercustommsg.jpg", _
                                    grhpath & "botonguardarclickcustommsg.jpg", me)
    call cbotoncancelar.initialize(imgcancelar, grhpath & "botoncancelarcustommsg.jpg", grhpath & "botoncancelarrollovercustommsg.jpg", _
                                    grhpath & "botoncancelarclickcustommsg.jpg", me)
end sub

private sub form_mousemove(button as integer, shift as integer, x as single, y as single)
    lastpressed.toggletonormal
end sub

private sub imgcancelar_click()
    unload me
end sub

private sub imgguardar_click()
on error goto errhandler
    dim i as long
    
    for i = 0 to 9
        custommessages.message(i) = messagetxt(i)
    next i
    
    unload me
exit sub

errhandler:
    'did detected an invalid message??
    if err.number = custommessages.invalidmessageerrcode then
        call msgbox("el mensaje " & cstr(i + 1) & " es invï¿½lido. modifiquelo por favor.")
    end if

end sub

private sub messagetxt_mousemove(index as integer, button as integer, shift as integer, x as single, y as single)
    lastpressed.toggletonormal
end sub
